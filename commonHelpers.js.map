{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nconst PAGE_SIZE = 15;\nconst API_KEY = '42335875-35ce8b2853e0e3d6760ada5fc';\nconst BASE_URL = `https://pixabay.com/api/?key=${API_KEY}&image_type=photo&orientation=horizontal&safesearch=true&per_page=${PAGE_SIZE}`;\nconst form = document.querySelector('.js-search-form');\nconst gallery = document.querySelector('.js-gallery');\nconst loadMoreBtn = document.querySelector(\".load-more\");\nconst loader = document.querySelector(\".loader\");\nlet currentPage = 1;\nlet currentQuery = null;\nlet totalPages = 1;\n\nlet lightbox = new SimpleLightbox('.gallery a');\n\nfunction showError(msg) {\n    iziToast.show({\n        message: msg,\n        messageColor: '#fff',\n        position: 'topRight',\n        backgroundColor: '#ef4040',\n        animateInside: false,\n        color: '#fff'\n    });\n}\n\nasync function getImages(query, page) {\n    let markup = '';\n    try {\n        const url = `${BASE_URL}&q=${encodeURIComponent(query)}&page=${page}`;\n        const response = await axios.get(url);\n        const data = response.data;\n\n        if (!data || data.hits.length === 0) {\n            showError(\"Sorry, there are no images matching your search query. Please try again!\");\n            gallery.innerHTML = '';\n            totalPages = 0;\n            return '';\n        }\n\n        totalPages = Math.ceil(data.totalHits / PAGE_SIZE);\n\n        markup = data.hits.map(image => {\n            return `<a href=\"${image.largeImageURL}\">\n                <img src=\"${image.webformatURL}\">\n                <div>\n                    <span>likes<br>${image.likes}</span>\n                    <span>views<br>${image.views}</span>\n                    <span>comments<br>${image.comments}</span>\n                    <span>downloads<br>${image.downloads}</span>\n                </div>\n            </a>`\n        }).join('');\n    } catch (e) {\n        showError(e.message);\n        gallery.innerHTML = '';\n    }\n    return markup;\n}\n\nfunction smoothScroll() {\n    const galleryLinks = document.querySelectorAll('.gallery a');\n    const cardHeight = galleryLinks.length > 0 ? galleryLinks[0].getBoundingClientRect().height : 0;\n    window.scrollBy({ top: cardHeight * 2, behavior: 'smooth' });\n}\n\n\nform.addEventListener('submit', async e => {\n    e.preventDefault();\n\n    const formData = new FormData(e.target);\n    const query = formData.get('search-input').trim();\n\n    currentPage = 1;\n    totalPages = 0;\n\n    if (!query) {\n        showError(\"Sorry, there are no images matching your search query. Please try again!\");\n        gallery.innerHTML = '';\n        currentQuery = null;\n        return;\n    }\n\n    loader.classList.remove('hidden');\n    \n    currentQuery = query;\n    const markup = await getImages(query, currentPage);\n    \n    gallery.innerHTML = markup;\n    lightbox.refresh();\n    loader.classList.add('hidden');\n    if (totalPages > 1) {\n        loadMoreBtn.classList.remove('hidden');\n    } else {\n        loadMoreBtn.classList.add('hidden');\n    }\n    \n})\n\nloadMoreBtn.addEventListener('click', async (e)=> {\n    e.preventDefault();\n\n    if (!currentQuery) {\n        showError(\"Sorry, there are no images matching your search query. Please try again!\");\n        gallery.innerHTML = '';\n        return;\n    }\n\n    loader.classList.remove('hidden');\n    \n    \n    if (currentPage < totalPages) {\n        currentPage += 1;\n        const markup = await getImages(currentQuery, currentPage);\n    \n        gallery.innerHTML += markup;\n        lightbox.refresh();\n        smoothScroll();\n    } else {\n        showError(\"We're sorry, but you've reached the end of search results.\");\n        loadMoreBtn.classList.add('hidden');\n    }\n    loader.classList.add('hidden');\n    \n})\n"],"names":["PAGE_SIZE","API_KEY","BASE_URL","form","gallery","loadMoreBtn","loader","currentPage","currentQuery","totalPages","lightbox","SimpleLightbox","showError","msg","iziToast","getImages","query","page","markup","url","data","axios","image","e","smoothScroll","galleryLinks","cardHeight"],"mappings":"owBAQA,MAAMA,EAAY,GACZC,EAAU,qCACVC,EAAW,gCAAgCD,CAAO,qEAAqED,CAAS,GAChIG,EAAO,SAAS,cAAc,iBAAiB,EAC/CC,EAAU,SAAS,cAAc,aAAa,EAC9CC,EAAc,SAAS,cAAc,YAAY,EACjDC,EAAS,SAAS,cAAc,SAAS,EAC/C,IAAIC,EAAc,EACdC,EAAe,KACfC,EAAa,EAEbC,EAAW,IAAIC,EAAe,YAAY,EAE9C,SAASC,EAAUC,EAAK,CACpBC,EAAS,KAAK,CACV,QAASD,EACT,aAAc,OACd,SAAU,WACV,gBAAiB,UACjB,cAAe,GACf,MAAO,MACf,CAAK,CACL,CAEA,eAAeE,EAAUC,EAAOC,EAAM,CAClC,IAAIC,EAAS,GACb,GAAI,CACA,MAAMC,EAAM,GAAGjB,CAAQ,MAAM,mBAAmBc,CAAK,CAAC,SAASC,CAAI,GAE7DG,GADW,MAAMC,EAAM,IAAIF,CAAG,GACd,KAEtB,GAAI,CAACC,GAAQA,EAAK,KAAK,SAAW,EAC9B,OAAAR,EAAU,0EAA0E,EACpFR,EAAQ,UAAY,GACpBK,EAAa,EACN,GAGXA,EAAa,KAAK,KAAKW,EAAK,UAAYpB,CAAS,EAEjDkB,EAASE,EAAK,KAAK,IAAIE,GACZ,YAAYA,EAAM,aAAa;AAAA,4BACtBA,EAAM,YAAY;AAAA;AAAA,qCAETA,EAAM,KAAK;AAAA,qCACXA,EAAM,KAAK;AAAA,wCACRA,EAAM,QAAQ;AAAA,yCACbA,EAAM,SAAS;AAAA;AAAA,iBAG/C,EAAE,KAAK,EAAE,CACb,OAAQC,EAAG,CACRX,EAAUW,EAAE,OAAO,EACnBnB,EAAQ,UAAY,EACvB,CACD,OAAOc,CACX,CAEA,SAASM,GAAe,CACpB,MAAMC,EAAe,SAAS,iBAAiB,YAAY,EACrDC,EAAaD,EAAa,OAAS,EAAIA,EAAa,CAAC,EAAE,sBAAqB,EAAG,OAAS,EAC9F,OAAO,SAAS,CAAE,IAAKC,EAAa,EAAG,SAAU,QAAQ,CAAE,CAC/D,CAGAvB,EAAK,iBAAiB,SAAU,MAAMoB,GAAK,CACvCA,EAAE,eAAc,EAGhB,MAAMP,EADW,IAAI,SAASO,EAAE,MAAM,EACf,IAAI,cAAc,EAAE,KAAI,EAK/C,GAHAhB,EAAc,EACdE,EAAa,EAET,CAACO,EAAO,CACRJ,EAAU,0EAA0E,EACpFR,EAAQ,UAAY,GACpBI,EAAe,KACf,MACH,CAEDF,EAAO,UAAU,OAAO,QAAQ,EAEhCE,EAAeQ,EACf,MAAME,EAAS,MAAMH,EAAUC,EAAOT,CAAW,EAEjDH,EAAQ,UAAYc,EACpBR,EAAS,QAAO,EAChBJ,EAAO,UAAU,IAAI,QAAQ,EACzBG,EAAa,EACbJ,EAAY,UAAU,OAAO,QAAQ,EAErCA,EAAY,UAAU,IAAI,QAAQ,CAG1C,CAAC,EAEDA,EAAY,iBAAiB,QAAS,MAAOkB,GAAK,CAG9C,GAFAA,EAAE,eAAc,EAEZ,CAACf,EAAc,CACfI,EAAU,0EAA0E,EACpFR,EAAQ,UAAY,GACpB,MACH,CAKD,GAHAE,EAAO,UAAU,OAAO,QAAQ,EAG5BC,EAAcE,EAAY,CAC1BF,GAAe,EACf,MAAMW,EAAS,MAAMH,EAAUP,EAAcD,CAAW,EAExDH,EAAQ,WAAac,EACrBR,EAAS,QAAO,EAChBc,GACR,MACQZ,EAAU,4DAA4D,EACtEP,EAAY,UAAU,IAAI,QAAQ,EAEtCC,EAAO,UAAU,IAAI,QAAQ,CAEjC,CAAC"}